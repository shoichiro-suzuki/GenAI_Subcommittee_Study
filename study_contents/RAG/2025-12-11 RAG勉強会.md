# RAGの技術仕様教育

## 本教育の目的
詳細な個別技術の紹介というより、各フェーズに必要な観点と観点に関係する先行技術スタックを紹介し、事後に独自に調査できる下地を作る。
まずは「観点とキーワードをきいたことがある」程度の理解でよい。

## メニュー
- データベース作成フェーズ
	- ドキュメント取り込み戦略
		- 電子化する情報の範囲：テキストが基本、画像も含める？他にもある？
			- マルチモーダル対応（表・画像・構造化データ）、OCR・Layout解析（Document Intelligence）
		- メタデータ付与：有用なメタデータ付与する意図と効果
		- 文章の正規化：どの様な正規化が効くか
		- 用語の統一：ベストプラクティスの例示
		- 他にはどんなものがある？
	- エンベディングモデル選定戦略：モデル差による精度への影響
		- MTEB/ JMTEBなどベンチマーク、日英モデル比較（OpenAI, PLaMo, E5, Cohere）
		- コンテキスト長・次元数・推論コストのトレードオフ
	- チャンキング戦略
		- ルールベース
			- 固定長チャンク（文字・トークン数）：コスト極小だが意味的断裂が懸念
			- オーバーラップ固定長チャンク：固定長だが前後チャンクとわずかな重複部分を持ち、意味的断裂を補強
		- セマンティックチャンク（エンベディングチャンク）
			- 文節などでエンベディングし、隣接または特定範囲内の意味的類似度を計算。意味的にまとまりのある範囲でクラスタ化して正式チャンクとする
			- その他の手法
				- Late Chunking
				- RAPTOR
				- LLMチャンク
				- Parent-Child / Small-to-Big（階層構造）
				- Agentic Chunking（LLMが分割境界を決定）

- Retrievalフェーズ
	- 検索戦略：様々な検索手法の存在と組み合わせ方法を例示
		- ベクトル検索
		- フルテキスト検索
		- セマンティック検索
		- メタデータフィルター
		- ハイブリッド検索（BM25+ベクトル+RRF）
		- HyDE / Multi-Query / Self-Query / Contextual Retrieval
		- Graph RAG（ナレッジグラフ検索）
	- リランク戦略：様々なリランク手法の存在を例示。また、組み合わせ方法があれば例示。
		- RRF
		- セマンティックランカー
		- Cross-Encoder / BGE / Cohere / ColBERT / FlashRank（軽量CPU）
		- LLM-based Listwise Rerank（RankZephyr等）

- Augmented Generationフェーズ
	- プロンプトエンジニアリング戦略
		- チャンクの最終選定
		- メタデータの利用
		- ハルシネーション抑制
			- 情報が足らないときの出力方法の指定
			- 回答ソースの明示指示

## 評価観点（Measurement）
- Quality Scores: Context Relevance / Answer Relevance / Faithfulness
- Key Abilities: Noise Robustness（ノイズ混入耐性）、Negative Rejection（不足時の無回答/保留）、Information Integration（複数ソース統合）、Counterfactual Robustness（誤情報検知・除外）
- Retrieval評価（Recall@K等）、Lost-in-the-Middle検証
- コスト・レイテンシの同時最適化（チャンクサイズチューニングを含む）


## 関連Webコンテンツ
### リランク戦略
[RAGにおけるRerankモデルの役割と最新の動向](https://zenn.dev/shirochan/articles/06246f5bc8eb3d)
[RAGでの回答精度向上のためのテクニック集（応用編-A）](https://zenn.dev/knowledgesense/articles/cec1cd43244524)
[チートシートと高度なRAG構築のレシピ](https://www.llamaindex.ai/blog/a-cheat-sheet-and-some-recipes-for-building-advanced-rag-803a9d94c41b)
[日本語テキストの前処理：neologdn、大文字小文字、Unicode正規化 - tuttieee’s blog](https://tuttieee.hatenablog.com/entry/ja-nlp-preprocess)
[MTEB Leaderboard - a Hugging Face Space by mteb](https://huggingface.co/spaces/mteb/leaderboard)
[RAGのためのチャンク戦略の習得:ベストプラクティスとコード例](https://community.databricks.com/t5/technical-blog/the-ultimate-guide-to-chunking-strategies-for-rag-applications/ba-p/113089)


**RAG構築 チートシート**
![チートシート](https://cdn.sanity.io/images/7m9jw85w/production/6cfb645c4e5dfea8f3e5a590c3d2bc1cbfcfead3-5818x7805.png?w=5818)
