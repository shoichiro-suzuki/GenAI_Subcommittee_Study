# Function Calling 学習資料

## 1. 概要

### 1.1 Function Callingとは
- LLMが外部ツール・APIと連携する仕組み
- テキスト生成を超えた実用的な機能の実現

### 1.2 主な利用シーン
- データベースサーチ
- 機械的な処理（データ変換、計算処理等）

## 2. 技術仕様

### 2.1 基本的なワークフロー
1. ツール定義（名前、説明、入力スキーマ）
2. OpenAI APIへのリクエスト
3. LLMによるツール選択・引数生成（JSON）
4. クライアント側でツール実行
5. 実行結果をAPIへフィードバック
6. 最終レスポンス生成

### 2.2 ツール定義（JSON Schema）
- 従来型ツール（type: "function"）
- カスタムツール（type: "custom"、GPT-5以降）
- パラメータ設計のポイント

### 2.3 APIリクエスト形式
- messagesパラメータ
- toolsパラメータ
- tool_choice パラメータ（完全なコード例）
- verbosity パラメータ（GPT-5以降）
- reasoning_effort パラメータ（GPT-5.1-thinking）

### 2.4 レスポンス形式
- finish_reason: "tool_calls"
- message.tool_calls配列
- tool_call_id
- function引数のJSON

### 補足：最新モデル情報
- GPT-5シリーズ
- GPT-5.1シリーズ

## 3. 実装パターンと実例

### 3.1 データベースサーチの実装
- ツール定義例（SQLクエリ実行関数）
- パラメータ設計（テーブル名、検索条件等）
- 実装例
- **疑似的なやり取り（IN/OUTサンプル）**

### 3.2 機械的な処理の実装
- ツール定義例（データ変換、計算処理関数）
- パラメータ設計（入力データ、処理タイプ等）
- 実装例
- **疑似的なやり取り（IN/OUTサンプル）**
- enum活用による安定出力

## 4. ベストプラクティス

### 4.1 ツール設計
- 明確な関数名と説明
- 適切な粒度
- エラーメッセージの設計

### 4.2 セキュリティ
- **SQLインジェクション対策**（リスク解説と詳細な対策）
- **入力検証**（リスク解説と詳細な対策）
- **権限管理**（リスク解説と詳細な対策）
- レート制限

### 4.3 パフォーマンス
- トークン使用量の最適化
- レスポンスタイムの改善

## 5. 参考リソース

### 5.1 公式ドキュメント
- OpenAI Platform Docs - Function Calling
- OpenAI Cookbook (GitHub)

### 5.2 コード例・チュートリアル
- 初級者向け
- 中級者向け
- 上級者向け
- 実装例別リファレンス
- 学習パス推奨
