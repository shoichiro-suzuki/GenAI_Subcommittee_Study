# Function Calling 学習資料

## 1. 概要

### 1.1 Function Callingとは
- LLMが外部ツール・APIと連携する仕組み
- テキスト生成を超えた実用的な機能の実現

### 1.2 主な利用シーン
- データベースサーチ
- 機械的な処理（データ変換、計算処理等）

## 2. OpenAI Function Calling

### 2.1 対応モデル
- GPT-5シリーズ（2025年8月、最新）
- GPT-5.1シリーズ（2025年11月、最新）
- GPT-4o/GPT-4/GPT-3.5（後方互換）

### 2.2 API構造
- 基本的なAPI呼び出し（JSONツール）
- カスタムツール（GPT-5新機能）
- tools パラメータ
- tool_choice パラメータ
- verbosity パラメータ（GPT-5以降）
- reasoning_effort パラメータ（GPT-5.1-thinking）
- レスポンス形式

## 3. 技術仕様

### 3.1 基本的なワークフロー
1. ツール定義（名前、説明、入力スキーマ）
2. OpenAI APIへのリクエスト
3. LLMによるツール選択・引数生成（JSON）
4. クライアント側でツール実行
5. 実行結果をAPIへフィードバック
6. 最終レスポンス生成

### 3.2 ツール定義（JSON Schema）
- type: "function"
- function.name: 関数名
- function.description: 関数の説明
- function.parameters: パラメータスキーマ

### 3.3 APIリクエスト形式
- messagesパラメータ
- toolsパラメータ
- tool_choice パラメータ（"auto", "required", "none", または特定関数指定）

### 3.4 レスポンス形式
- finish_reason: "tool_calls"
- message.tool_calls配列
- tool_call_id
- function引数のJSON

## 4. 実装パターンと実例

### 4.1 データベースサーチの実装
- ツール定義例（SQLクエリ実行関数）
- パラメータ設計（テーブル名、検索条件等）
- 実行フロー
- エラーハンドリング

### 4.2 機械的な処理の実装
- ツール定義例（データ変換、計算処理関数）
- パラメータ設計（入力データ、処理タイプ等）
- 実行フロー
- 結果の構造化出力

## 5. ベストプラクティス

### 5.1 ツール設計
- 明確な関数名と説明
- 適切な粒度
- エラーメッセージの設計

### 5.2 セキュリティ
- 入力検証
- SQLインジェクション対策
- 権限管理

### 5.3 パフォーマンス
- トークン使用量の最適化
- レスポンスタイムの改善

## 6. 参考リソース

### 6.1 公式ドキュメント
- OpenAI Platform Docs - Function Calling
- OpenAI Cookbook (GitHub)

### 6.2 コード例・チュートリアル
- DataCamp Tutorial
- How to call functions with chat models (公式Notebook)

---

**最終更新**: 2025年版情報に基づく
**対象**: LLM開発者・AIエンジニア向け
